trading:
  cors:
    allowed-origins: ${TRADING_CORS_ALLOWED_ORIGINS:}
    allowed-methods: GET,POST,PUT,DELETE,OPTIONS
    allowed-headers: Authorization,Content-Type,X-API-KEY
    allow-credentials: false
    max-age: 3600
  marketdata:
    base-url: https://www.alphavantage.co
    api-key: ${MARKETDATA_API_KEY:${ALPHA_VANTAGE_API_KEY}}
    health-symbol: ${MARKETDATA_HEALTH_SYMBOL:SPY}
    health-cache-ttl: ${MARKETDATA_HEALTH_CACHE_TTL:PT1M}
    connect-timeout: 2s
    read-timeout: 5s
    write-timeout: 5s
    retry:
      max-attempts: ${TRADING_MARKETDATA_RETRY_MAX_ATTEMPTS:3}
      initial-backoff: ${TRADING_MARKETDATA_RETRY_INITIAL_BACKOFF:PT0.5S}
      max-backoff: ${TRADING_MARKETDATA_RETRY_MAX_BACKOFF:PT5S}
  cache:
    quotes:
      ttl: ${TRADING_CACHE_QUOTES_TTL:PT30S}
      maximum-size: ${TRADING_CACHE_QUOTES_MAXIMUM_SIZE:1024}
  api:
    key: ${TRADING_API_KEY:}
    header-name: ${TRADING_API_KEY_HEADER:X-API-KEY}
  rate-limit:
    enabled: ${TRADING_RATE_LIMIT_ENABLED:true}
    requests-per-minute: ${TRADING_RATE_LIMIT_REQUESTS_PER_MINUTE:100}
    quote-requests-per-minute: ${TRADING_RATE_LIMIT_QUOTE_REQUESTS_PER_MINUTE:30}

spring:
  profiles:
    default: dev
  security:
    user:
      name: ${MANAGEMENT_USERNAME:actuator}
      password: ${MANAGEMENT_PASSWORD}
      roles: ACTUATOR

management:
  endpoints:
    web:
      exposure:
        include: health
  endpoint:
    health:
      show-details: when_authorized
      show-components: when_authorized

---
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    url: jdbc:h2:mem:trading-dashboard;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:
  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
  flyway:
    enabled: false
  h2:
    console:
      enabled: true

---
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    url: ${SPRING_DATASOURCE_URL:${POSTGRES_URL:jdbc:postgresql://localhost:5432/trader}}
    username: ${SPRING_DATASOURCE_USERNAME:${POSTGRES_USER:trader}}
    password: ${SPRING_DATASOURCE_PASSWORD:${POSTGRES_PASSWORD}}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
  flyway:
    enabled: ${SPRING_FLYWAY_ENABLED:true}
    locations: classpath:db/migration

---
spring:
  config:
    activate:
      on-profile: test
  datasource:
    url: jdbc:h2:mem:trading-dashboard-test;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:
  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
  flyway:
    enabled: true
    locations: classpath:db/migration
